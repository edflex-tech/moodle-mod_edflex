{"version":3,"file":"testconnection.min.js","sources":["../src/testconnection.js"],"sourcesContent":["import Ajax from 'core/ajax';\nimport {get_strings as getStrings} from 'core/str';\n\nexport const init = () => {\n    document.body.addEventListener('click', async (e) => {\n        if (e.target && e.target.id === 'mod_edflex_test_api_connection_btn') {\n            const [successMessage, errorMessage] = await getStrings([\n                {key: 'apiconnectionsuccess', component: 'mod_edflex'},\n                {key: 'apiconnectionerror', component: 'mod_edflex'}\n            ]);\n\n            const notificationContainer = document.getElementById('mod_edflex_connection_status');\n            notificationContainer.textContent = '';\n\n            const apiurl = document.getElementById('id_s_mod_edflex_apiurl')?.value || '';\n            const clientid = document.getElementById('id_s_mod_edflex_clientid')?.value || '';\n            const clientsecret = document.getElementById('id_s_mod_edflex_clientsecret')?.value || '';\n\n            const args = { apiurl, clientid, clientsecret };\n\n            const xhr = Ajax.call([{\n                methodname: 'mod_edflex_test_api_connection',\n                args: args\n            }])[0];\n\n            xhr.done((response) => {\n                if (response.success) {\n                    notificationContainer.textContent = successMessage;\n                } else {\n                    notificationContainer.textContent = errorMessage;\n                }\n            });\n\n            xhr.fail((error) => {\n                const msg = error?.message || '';\n                const pre = document.createElement('pre');\n                pre.textContent = `${errorMessage} ${msg}`;\n                notificationContainer.textContent = '';\n                notificationContainer.appendChild(pre);\n            });\n        }\n    });\n};\n"],"names":["document","body","addEventListener","async","e","target","id","successMessage","errorMessage","key","component","notificationContainer","getElementById","textContent","args","apiurl","value","clientid","clientsecret","xhr","Ajax","call","methodname","done","response","success","fail","error","msg","message","pre","createElement","appendChild"],"mappings":"4PAGoB,KAChBA,SAASC,KAAKC,iBAAiB,SAASC,MAAAA,OAChCC,EAAEC,QAA0B,uCAAhBD,EAAEC,OAAOC,GAA6C,+EAC3DC,eAAgBC,oBAAsB,oBAAW,CACpD,CAACC,IAAK,uBAAwBC,UAAW,cACzC,CAACD,IAAK,qBAAsBC,UAAW,gBAGrCC,sBAAwBX,SAASY,eAAe,gCACtDD,sBAAsBE,YAAc,SAM9BC,KAAO,CAAEC,sCAJAf,SAASY,eAAe,wFAA2BI,QAAS,GAIpDC,yCAHNjB,SAASY,eAAe,4FAA6BI,QAAS,GAG9CE,6CAFZlB,SAASY,eAAe,gGAAiCI,QAAS,IAIjFG,IAAMC,cAAKC,KAAK,CAAC,CACnBC,WAAY,iCACZR,KAAMA,QACN,GAEJK,IAAII,MAAMC,WACFA,SAASC,QACTd,sBAAsBE,YAAcN,eAEpCI,sBAAsBE,YAAcL,gBAI5CW,IAAIO,MAAMC,cACAC,KAAMD,MAAAA,aAAAA,MAAOE,UAAW,GACxBC,IAAM9B,SAAS+B,cAAc,OACnCD,IAAIjB,sBAAiBL,yBAAgBoB,KACrCjB,sBAAsBE,YAAc,GACpCF,sBAAsBqB,YAAYF"}